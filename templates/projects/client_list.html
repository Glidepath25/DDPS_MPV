{% extends 'base.html' %}
{% block title %}Clients | DDPS{% endblock %}
{% block content %}
<div class='d-flex justify-content-between align-items-center mb-3'>
    <h1 class='h3 mb-0'>Clients</h1>
    <a class='btn btn-primary' href='{% url 'project-create' %}'>New project</a>
</div>
<div class='table-responsive bg-white shadow-sm rounded'>
    <table class='table table-striped align-middle mb-0'>
        <thead>
            <tr>
                <th scope='col'>Name</th>
                <th scope='col'>Account code</th>
                <th scope='col'>Account manager</th>
                <th scope='col'>Projects</th>
                <th scope='col'>Actual revenue</th>
                <th scope='col'>Forecast revenue</th>
            </tr>
        </thead>
        <tbody>
            {% for client in clients %}
            <tr>
                <td><a href='{% url 'client-detail' client.pk %}'>{{ client.name }}</a></td>
                <td>{{ client.account_code }}</td>
                <td>{% if client.account_manager %}{{ client.account_manager.get_full_name|default:client.account_manager.username }}{% else %}-{% endif %}</td>
                <td>{{ client.projects.count }}</td>
                <td>{% if request.user.can_view_finance %}&pound;{{ client.revenue_actual }}{% else %}-{% endif %}</td>
                <td>&pound;{{ client.revenue_forecast }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan='6' class='text-center py-4 text-muted'>No clients found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
